# Contributor: starwarsfan <yves@eisfair.org>
# Maintainer:
pkgname=lcd4linux
pkgver=0.12.0
pkgrel=0
pkgdesc="LCD4Linux"
url="http://ssl.bulix.org/projects/lcd4linux/"
arch="all"
license="GPL"
depends=""
depends_dev="libusb-compat-dev libtool automake autoconf gettext-dev linux-headers"
makedepends="$depends_dev"
install=""
source="http://download.eisfair.org/src/${pkgname}-trunk-1200.zip
	plugin_i2c_sensors.c.patch
	"

_builddir="$srcdir/trunk"

prepare() {
	local i
	cd "$_builddir"
	for i in ${source}; do
		case ${i} in
    		*.patch) msg ${i}; patch -p1 -i "$srcdir"/${i} || return 1;;
		esac
	done
}

build() {
	cd "$_builddir"
	./bootstrap
	#exclude not supported driver
	case "$CARCH" in
	    arm*) drivers="all,!RouterBoard,!TeakLCM" ;;
	    x86) drivers="all,!TeakLCM" ;;
	    x86_64) drivers="all,!TeakLCM" ;;
	esac
	./configure \
	    --prefix=/usr \
	    --without-x \
	    --without-python \
	    --with-drivers="$drivers" || return 1
	make || return 1
}

package() {
	cd "$_builddir"
	make -j1 DESTDIR="$pkgdir" install || return 1
	mkdir -p -m 755 ${pkgdir}/etc/${pkgname} || return 1
	install -m644 -D "$_builddir/lcd4linux.conf.sample" \
		 ${pkgdir}/etc/${pkgname}/lcd4linux.conf.sample || return 1
}

md5sums="697f225ef271a370bab2b8f8375a76df  lcd4linux-trunk-1200.zip
07515690b392eeb44374aaff977194e8  plugin_i2c_sensors.c.patch"
sha256sums="a22e4fb0df70dbc8224edeebaf5402b69a8eca1e658da7573b1331f124a63396  lcd4linux-trunk-1200.zip
1a6a9e68be0ae91ab366b319cfbcc1a1fea4ae837984f3575cd9152349e57713  plugin_i2c_sensors.c.patch"
sha512sums="dc4f4a9df499dd5d0bb3619653968791e5a425861cdf34f1d082e45e6eeec4e452d0a453e60ec67b67c321cb1c2aad1541237e37ea7a39a0fa59c841be3144bb  lcd4linux-trunk-1200.zip
e0a9ac5692d08ebbd3c513f95ef47ac0b04af4a13a44d97407cd921c96e538b6875f0c7756411f1ce2787df6aa18370e9e7e80fc55958f14a22fce2736177359  plugin_i2c_sensors.c.patch"
