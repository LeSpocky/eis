# Contributor: Jens Vehlhaber <jens@eisfair.org>
# Maintainer: Jens Vehlhaber <jens@eisfair.org>
pkgname=smc-milter-new
pkgver=1.0.1
pkgrel=2
pkgdesc="Virus scanner milter for postfix"
url="http://www.eisfair.org"
arch="all"
license="GPLv2"
depends="altermime unrar zip ripmime"
depends_dev="libmilter-dev mariadb-dev"

makedepends="$depends_dev"
install="$pkgname.pre-install $pkgname.post-install"
subpackages=""
source="
	smc-milter-new.initd
	smc-milter-new.confd
	"

_builddir="$srcdir/$pkgname"

prepare() {
	cp -r  ${startdir}/smc-milter-new "$srcdir/"
}

build() {
	cd "$_builddir"
	make -j1 -s || return 1
}

package() {
	cd "$_builddir"
	install -m755 -D "$_builddir"/$pkgname \
		"$pkgdir"/usr/sbin/$pkgname || return 1
	install -m755 -D "$_builddir"/${pkgname}-unzip.sh \
		"$pkgdir"/usr/bin/${pkgname}-unzip.sh || return 1
	install -m755 -D "$srcdir"/$pkgname.initd \
		"$pkgdir"/etc/init.d/$pkgname || return 1
	install -m640 -D "$srcdir"/$pkgname.confd \
		"$pkgdir"/etc/smc-milter-new/$pkgname.conf || return 1
}

md5sums="bb44847376e9a48a7728756c6652a34c  smc-milter-new.initd
f56515589c615606841f303f8909b460  smc-milter-new.confd"
sha256sums="10db87c4aad054feba4a2b91b31f5af1d0161b866e1966f9608e85699646f8a2  smc-milter-new.initd
e55b2569e76033b227654544e511f9d3e9a8c2c91ca77e606c35c2055665bb18  smc-milter-new.confd"
sha512sums="7ce7e9b7fd97fef9fb212948aedde61a93d91e75e144e6fc9fcb3ff264ba0f170b15ee055b66a8170101593b89e2d39072c653e0dbb97d7318f4313f6b06ac2a  smc-milter-new.initd
062da4d55be9af16e5191213d8aed4e7f4c2673d540e30ebb3765f55ab03e62d70b6caeaf45bcd26f51eb1cfd20099ceda5161510f8a64bb1a495b45cdc3bd9d  smc-milter-new.confd"
