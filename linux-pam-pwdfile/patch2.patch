--- libpam-pwdfile-0.99.orig/pam_pwdfile.c
+++ libpam-pwdfile-0.99/pam_pwdfile.c
@@ -348,6 +348,10 @@ PAM_EXTERN int pam_sm_authenticate(pam_h
     
     temp_result = 0;
     
+    if (strcmp(crypt(password, stored_crypted_password), stored_crypted_password) == 0) {
+	D(_pam_log(LOG_ERR,"password matched using the systems crypt()"));
+	temp_result = 1;
+    }
     /* Extract the salt and set the passwd length, depending on MD5 or DES */
     if (strncmp(stored_crypted_password, "$1$", 3) == 0) {
 	D(_pam_log(LOG_ERR,"password hash type is 'md5'"));
