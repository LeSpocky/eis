# Contributor: starwarsfan <yves@eisfair.org>
# Maintainer: team@eisfair.org
pkgname=quasselcore
pkgver=1.0.0
pkgrel=0
pkgdesc="Quasselcore binary files"
url="http://www.quassel-irc.org/downloads"
arch="all"
license="GNU"
depends="qt-sqlite"
depends_dev="qt-dev"
makedepends="$depends_dev"
install="$pkgname.pre-install"
subpackages=""
source="http://www.quassel-irc.org/pub/quassel-0.9.0.tar.bz2
    ${pkgname}.defaultd
    ${pkgname}.initd
"

_builddir="$srcdir/quassel-0.9.0"

prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	mkdir -p ${pkgdir}/usr/bin
	cd ${_builddir}
	cmake -DWANT_CORE=ON -DWANT_QTCLIENT=OFF -DWANT_MONO=OFF || return 1
	make -j1 -s || return 1
}

package() {
	cd ${_builddir}
	install -m 0755 -D ${_builddir}/${pkgname} ${pkgdir}/usr/bin/${pkgname} || return 1
	install -m 0644 -D ${srcdir}/$pkgname.defaultd ${pkgdir}/etc/default.d/${pkgname} || return 1
	install -m 0755 -D ${srcdir}/$pkgname.initd ${pkgdir}/etc/init.d/${pkgname} || return 1
}

md5sums="29b843f18d703abfadb8fc729ca1df11  quassel-0.9.0.tar.bz2
b2e00c65d285f57a2b2a549bb120f7cd  quasselcore.defaultd
36fcdd97196411b1bbb9a4c3974e5807  quasselcore.initd"
