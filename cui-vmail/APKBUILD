# Contributor: jv <jens@eisfair.org>
# Maintainer: jv <jens@eisfair.org>
pkgname=cui-vmail
pkgver=1.0.0
pkgrel=0
pkgdesc="CUI setup for postfix/dovecot with virtual mail user"
url="http://www.eisfair.org"
arch="noarch"
license="GPL"
depends="cuimenu postfix-mysql pfqueue smc-milter-new dovecot dovecot-mysql dovecot-pigeonhole"
depends_dev=""
makedepends="$depends_dev"
install="$pkgname.pre-upgrade $pkgname.post-upgrade $pkgname.post-install $pkgname.post-deinstall"
subpackages=""
source="${pkgname}.default
		${pkgname}.check
		${pkgname}.check.exp
		${pkgname}.help
		${pkgname}.initd
		${pkgname}.sh
		${pkgname}-update.sh
		${pkgname}.menu
		${pkgname}.modules.menu
		${pkgname}.tools.menu
		${pkgname}.user.menu
		${pkgname}-modules-fetchmail
		${pkgname}-tools-recipient-access.cui.sh
		${pkgname}-user-maildropfilter.cui.sh
		${pkgname}-modules-maildropfilter
		${pkgname}-tools-sender-access.cui.sh
		${pkgname}-user-relaymap.cui.sh
		${pkgname}-modules-mailhandling
		${pkgname}-user-canonicalmap.cui.sh
		${pkgname}-user-userhandling.cui.sh
		${pkgname}-tools-client-access.cui.sh
		${pkgname}-user-domainhandling.cui.sh
		${pkgname}-tools-fetchmailhandling.cui.sh
		${pkgname}-user-forwardings.cui.sh
		${pkgname}.sqldata.sql
		${pkgname}.sqltable.sql
		${pkgname}.sqltrigger.sql
		${pkgname}.sqlview.sql
		${pkgname}.txt
"
_pname="vmail"
_builddir=

prepare() {
	cd "$_builddir"
}

build() {
	cd "$_builddir"
}

package() {
	cd "$_builddir"
	install -D -m644 ${srcdir}/${pkgname}.check         ${pkgdir}/etc/check.d/${_pname} || return 1
	install -D -m644 ${srcdir}/${pkgname}.check.exp     ${pkgdir}/etc/check.d/${_pname}.exp || return 1
	install -D -m640 ${srcdir}/${pkgname}.default       ${pkgdir}/etc/default.d/${_pname} || return 1
	install -D -m644 ${srcdir}/${pkgname}.help          ${pkgdir}/var/install/help/${_pname} || return 1
	install -D -m755 ${srcdir}/${pkgname}.initd         ${pkgdir}/etc/init.d/${_pname} || return 1
	install -D -m755 ${srcdir}/${pkgname}.sh            ${pkgdir}/var/install/config.d/${_pname}.sh || return 1
	install -D -m755 ${srcdir}/${pkgname}-update.sh     ${pkgdir}/var/install/config.d/${_pname}-update.sh || return 1
	install -D -m644 ${srcdir}/${pkgname}.menu          ${pkgdir}/var/install/menu/setup.services.${pkgname}.menu || return 
	install -D -m644 ${srcdir}/${pkgname}.modules.menu  ${pkgdir}/var/install/menu/setup.services.${pkgname}.modules.menu || return 
	install -D -m644 ${srcdir}/${pkgname}.tools.menu    ${pkgdir}/var/install/menu/setup.services.${pkgname}.tools.menu || return 
	install -D -m644 ${srcdir}/${pkgname}.user.menu     ${pkgdir}/var/install/menu/setup.services.${pkgname}.user.menu || return 
	install -D -m755 ${srcdir}/${pkgname}-modules-fetchmail              ${pkgdir}/var/install/bin/${pkgname}-modules-fetchmail
	install -D -m755 ${srcdir}/${pkgname}-tools-recipient-access.cui.sh  ${pkgdir}/var/install/bin/${pkgname}-tools-recipient-access.cui.sh
	install -D -m755 ${srcdir}/${pkgname}-user-maildropfilter.cui.sh     ${pkgdir}/var/install/bin/${pkgname}-user-maildropfilter.cui.sh
	install -D -m755 ${srcdir}/${pkgname}-modules-maildropfilter         ${pkgdir}/var/install/bin/${pkgname}-modules-maildropfilter
	install -D -m755 ${srcdir}/${pkgname}-tools-sender-access.cui.sh     ${pkgdir}/var/install/bin/${pkgname}-tools-sender-access.cui.sh
	install -D -m755 ${srcdir}/${pkgname}-user-relaymap.cui.sh           ${pkgdir}/var/install/bin/${pkgname}-user-relaymap.cui.sh
	install -D -m755 ${srcdir}/${pkgname}-modules-mailhandling           ${pkgdir}/var/install/bin/${pkgname}-modules-mailhandling
	install -D -m755 ${srcdir}/${pkgname}-user-canonicalmap.cui.sh       ${pkgdir}/var/install/bin/${pkgname}-user-canonicalmap.cui.sh
	install -D -m755 ${srcdir}/${pkgname}-user-userhandling.cui.sh       ${pkgdir}/var/install/bin/${pkgname}-user-userhandling.cui.sh
	install -D -m755 ${srcdir}/${pkgname}-tools-client-access.cui.sh     ${pkgdir}/var/install/bin/${pkgname}-tools-client-access.cui.sh
	install -D -m755 ${srcdir}/${pkgname}-user-domainhandling.cui.sh     ${pkgdir}/var/install/bin/${pkgname}-user-domainhandling.cui.sh
	install -D -m755 ${srcdir}/${pkgname}-tools-fetchmailhandling.cui.sh ${pkgdir}/var/install/bin/${pkgname}-tools-fetchmailhandling.cui.sh
	install -D -m755 ${srcdir}/${pkgname}-user-forwardings.cui.sh        ${pkgdir}/var/install/bin/${pkgname}-user-forwardings.cui.sh
	install -D -m644 ${srcdir}/${pkgname}.txt           ${pkgdir}/usr/share/doc/${_pname}/${_pname}.txt || return 1
}

md5sums="ec47b9619575f2d426c2018e5e902480  cui-vmail.default
675fb8c012eed5cd339448134b2f21f5  cui-vmail.check
45fd728e1d619a972a98ab1fc6ec1917  cui-vmail.check.exp
86735bcdcc8dc896ca39e188178a6d69  cui-vmail.help
b2a4d3e7b9f197cfa27c30ee9ac60a3d  cui-vmail.initd
1d5461fbdec63b9404890cdce3e038a5  cui-vmail.sh
b5c8c52c25ab08bc7480470423a9e324  cui-vmail-update.sh
0205c16ebd7fc14b121c92a621c456ca  cui-vmail.menu
5a3e69a8435af69f9c6fc4485a192cd6  cui-vmail.modules.menu
5d84f98192b9b90127e72d1c3555181a  cui-vmail.tools.menu
1507062eb8e4c147f45fa855a90c547f  cui-vmail.user.menu
cbc02e11b6cf874c58ae17ae0b3dd8eb  cui-vmail-modules-fetchmail
ec676e31d5272d6adbde2dad40f94541  cui-vmail-tools-recipient-access.cui.sh
9f21ffeece2204a686da43b0209525ff  cui-vmail-user-maildropfilter.cui.sh
ba28123b5711a325b44ab275ffc687c6  cui-vmail-modules-maildropfilter
944f23bddd5634b3942095aee08e3e80  cui-vmail-tools-sender-access.cui.sh
48ca3e3e72c90bf4a3be480c02d87d28  cui-vmail-user-relaymap.cui.sh
945e6a6c4510bfd4ccdf596a9d380ed7  cui-vmail-modules-mailhandling
78f614d6240b57f0628b40151f6a6825  cui-vmail-user-canonicalmap.cui.sh
65dfbcef1a33312282e85bb3af790878  cui-vmail-user-userhandling.cui.sh
e42e3395b935070ec8bc40ae8d36bc50  cui-vmail-tools-client-access.cui.sh
305d038fdd1f7e68fe12e32ba5478798  cui-vmail-user-domainhandling.cui.sh
fb1ac5b4cf0bf0d530a45d387f10200d  cui-vmail-tools-fetchmailhandling.cui.sh
dd12c646dd3791235b00a72a0f596218  cui-vmail-user-forwardings.cui.sh
09f44215aa0cad9e31696111288fd33c  cui-vmail.sqldata.sql
f27030b567735d880afbcef0ddce5362  cui-vmail.sqltable.sql
bf59f548cdaa552532b6211c0cd87b38  cui-vmail.sqltrigger.sql
380ca9971c02809dbd55a45261720355  cui-vmail.sqlview.sql
499bdd67aac01cf2fa6e821dc0aa2cea  cui-vmail.txt"
sha256sums="ddd4d416500c49cb0247504aebc23b8160acee307bd12935a2d2a9141574959c  cui-vmail.default
2f039fd2547bfb20cfd70d7532106d97687d971e69127fdbdbf52179ef0599be  cui-vmail.check
48ce211795336e8dc615cf9e4ae18ea4c49eb4fa1c504c3a70c005f39361d17b  cui-vmail.check.exp
03c1fc4e5ec3147b51a2774f4f850d597f56a7973c0d37d628c7178240d36631  cui-vmail.help
540bbee7fe847ca902e962d4d2bd3112f1a3fc6ac1030c85b84e67a26fc87d73  cui-vmail.initd
d5ecac71b6d87186eeed6d95ea6b50c04f5b903f762fd55f65c5a34b1ec688d8  cui-vmail.sh
af935a45fb873bb9c6468a8fd2049f42a965e35bccc04ae0adcefdc6ab1e8266  cui-vmail-update.sh
c3c50c454e014bcf2147e8868ae3b7a7dc5cc6087f1bdfe3c1fb7fb87f2c151e  cui-vmail.menu
79808136b4b692bcae3091cf487e4e79089f50bb3eb35a633cd51ee7e01d26b5  cui-vmail.modules.menu
bea349555162b7535fbc1cf7509a2d0acf8ecf235848245ce1586b171607b91b  cui-vmail.tools.menu
2692ae194d95604f13885db2017b0456e83cc4cb3ad817a627dd539a5ac95bca  cui-vmail.user.menu
c832d544b8b41e63dd3f9626320e081455c30bffb8518fbacfaf3501b425a313  cui-vmail-modules-fetchmail
d1d939c39aed4d7adb000f54c78ec1127029004be65f0527290ba91ec27689fc  cui-vmail-tools-recipient-access.cui.sh
ca31ce5d965f0ae8fa2d97a68d3e080757dc1212fefdddfdad2c19510ab9bcba  cui-vmail-user-maildropfilter.cui.sh
5ab56f33c528dd29ef1d33b1d9da18159d64eb4c4d5de49ef335472a53e56bc2  cui-vmail-modules-maildropfilter
14f9896bcb086fcceb49ceb7040bc5bc08dc23e75bcd11a76b699a4fa26f412a  cui-vmail-tools-sender-access.cui.sh
76e3a4f7504d250af8cd7509a55b2a6cdaedfe41d65d34a0027d1bfe45f881fd  cui-vmail-user-relaymap.cui.sh
01ac505d2d3ae7de581b42f27b08bb5949db11c537f109345f9844b76517962b  cui-vmail-modules-mailhandling
25b8d43a918edc4474a5e2156a51292b9c52d9eb0adcf6cfb04b33f8c8bdff3e  cui-vmail-user-canonicalmap.cui.sh
ed2dd2065f5640078900709209f767e59236a8cfd6a1c2eaf1bae455c04baad5  cui-vmail-user-userhandling.cui.sh
0d7d635e768e466610b269bda0befd726a47a5f980f9f08e875f64adc2e4e152  cui-vmail-tools-client-access.cui.sh
b00613a36b73f4c50ee9e3021592a070736b08dea1502345c6a98168967e29d3  cui-vmail-user-domainhandling.cui.sh
f94c42f57d32a4bd2b7b355ad2a60746f118779582d1df01fcdcc45b788898c6  cui-vmail-tools-fetchmailhandling.cui.sh
6cac1cf801d3c6ec00d95346f1b26d07220064ef9687393509c18077152156b2  cui-vmail-user-forwardings.cui.sh
1f250112d069ca8ea3ce0ef863ead99730c6c589ed81bec74d38b37aa8a69bc8  cui-vmail.sqldata.sql
9a03415296505947cd553cd8449ae5786eaeda6a09d31dfc6afcd900c0477927  cui-vmail.sqltable.sql
75cf5e38ce693b9f995c3265719c2dd1a9965ad02363695732e0cf2e7d47e537  cui-vmail.sqltrigger.sql
7d026771986d84117f6273f0fc1ac6bf96c5293003d4d391595677772472b944  cui-vmail.sqlview.sql
086eaa9f34dd9ac4b153c0d7995c65d93a9eb2598ebd02e5b61539a58f76ab6a  cui-vmail.txt"
sha512sums="63ab4b441c0e53990d990064dbd2c3c3135e262a9317cef10677bd0446d7894c56e35ff2ae9cf94007f50d7d0d0a8b9f0fadff81c7262689b78ad530eac2fb07  cui-vmail.default
a54ddbeaecbf439604f69e668a172cdaa73d31f3bf7cc55241746e0d241b16702f467dc7587fe7369ca2a36297c27e7781f8494a6db9c32939483490f71b7238  cui-vmail.check
5503fe9c36f152a4bc45ed119e4b68a06b44d05243dfe41ea3461143d82be66a956f07ce02320684c23875b4db471aa68ef96a6c6e82099166925f3b227af533  cui-vmail.check.exp
545f27f7f63416cec7bbd9a443908eb0dea882ba4debbd1a51dd94839381bf99b55dc87d63eeac9b5b2c0ee14d7e091a79b03750e2f6bdbbf0217fb5ac6561f3  cui-vmail.help
c833c7f71963034b53737576d004ffcd57abae586f7538aba0230730983e9ff6e90eb917f45ffcd2fec1f65d9759d5b36cc9ab55af503128a51c86852245f687  cui-vmail.initd
5796f35d5ae6039f150c678de7108464e2908c4eb87e3af9a11aae72537b342eb5172971f58b134d5bcf789115bd749d1199cd68ca6dfd17beb2c26ad31202cd  cui-vmail.sh
2caf4f0166dd999d7829feed0ef5af70f19cfb6048976aed85ea31b53d203d299e9ad33933140d56e12980e2e8cf534b3bf660f878c033f9fd7221c006998ea9  cui-vmail-update.sh
31a1cb8c9cda05589e306364f4e5956ed9c360b13f71f95302ea712100e326715fd5081e5a8a5ae855ac4b04feeb89100c9fddbe1198ec19e70cb89da95c47b9  cui-vmail.menu
1d1a7d1c6711a15b19edede0395c0018d3a83c50ccbae410307429b2f11f8f64ceeb7ad7879cf912c2d66b002910073b538b0834c95c550c8725f3c8e84ab8d3  cui-vmail.modules.menu
40ebd6be2100e1ac40b5c1b37be1cebe49ac9ff5b24ff081e094dad314849f5d9dff16750c6b27b374229c8934e2f4d1291c60117f20b0cc9733c426e0af3b4a  cui-vmail.tools.menu
ae016eb20b1ab587b7c8fa7443e3b6c57dc4408ad2b15960af846b63ca274ff6f61b2a63f22a308386022ae411e40b1cb27709cdae4f2f04ca48a9c0416696f0  cui-vmail.user.menu
286247d08168e61c02dd6b7afa9b3196366c89f60cccb4b341b4e67bb075ee42a977b550990f16373b2be8606ff8a9147d651eca1a7638039d7ba7e11750d806  cui-vmail-modules-fetchmail
e56a2e369266ff3ddd8e2a4964a787ce6042877f6a9e6288ee2dcc7dfcaef628fe03a1828d620757c9a5dcdd0b3c1bd79d4140f368907d9a470c7b399a6c9a68  cui-vmail-tools-recipient-access.cui.sh
8f5423aae1fdf4bdd569b80ddf6437a106bac08eb0e048458d366a18ae551affb012b93b6ce6371041c453f58cff464f463f64756e2b81deb2e7a9ecff289c36  cui-vmail-user-maildropfilter.cui.sh
bfb49516f53f9b8f5e4f747d3d16301b9ce0b622e8f3887bdbd92ae83872265d13bd012e4e724c08f999970a81c90838863103727299931c9328c67508aec250  cui-vmail-modules-maildropfilter
f561f8c8baa5a6aaadbea458a31d0ea0a89f1e61125f0e5583b1b265a837c3e51d34e2f7e534ccc812fd221dc55b6c905b93c24f91496b29a483dad8d36ae6e3  cui-vmail-tools-sender-access.cui.sh
0d2221a7c6f00f2beb9d4881315206fd16b55fe72c75116e812a971b55cc82379146d3c8e09c2b082d21d70fd6c918d4bb378f4eb57350953e779435586d7934  cui-vmail-user-relaymap.cui.sh
d00aa1f738847cd5b0264800b2f9cc368d8bf8f29c54a1e39ee1f8aa5b647468031dad12484895722e703db5c47814608e38e7d3aab91223217bde6f6a843ef0  cui-vmail-modules-mailhandling
e2d850b827acb7c5a4cb2da94e05943b843f64a78ed9edae20db620f4c470809d5624fccabc333676ebc4cb7e17af3552d58ae7c3fefb0813e36774f6cd42ce0  cui-vmail-user-canonicalmap.cui.sh
06bd8ed6b04458f90876aedcfbb4881f6b431b2ddbe95c4376cb26c1dda0f28c5328736818f269790680338cd1ab9a988c78241d77bbad267bade7157218080a  cui-vmail-user-userhandling.cui.sh
74b20c6f4dc1f0517f7b1b6a47484ef8bb79d9009bbaca97f2d59fec44211d4123438dc125369c0a6b7a11f3e1ed1926765210058c2d2a418b8a706a2be944ab  cui-vmail-tools-client-access.cui.sh
ac8abc016a5b219794ed05548f2321d1cfed857dd58a0645be15e500ad5ce34b7949486f085e8c215092ba1236761446b07b8aa536600b4de87f35e4ae790fb6  cui-vmail-user-domainhandling.cui.sh
c4aad053c3c0edbf82163ebf65fb024e68925cd8cd29dabccc001a0defae8750947391be03f025584efecb76ac0603d5d074d98202cba85915993e8d0a0e4a8b  cui-vmail-tools-fetchmailhandling.cui.sh
0caad00d7582f565e489b91998bc042c6afb7a7e293b8638fdf9ad829c068d6914b0ae9eaff9ce8117ceb675d605b4b3fb7a8df10f914a3dbb04d3ac26675f97  cui-vmail-user-forwardings.cui.sh
053c6a39d320a6e2395c292a02f8d2827492693a24c3ee1719f5b49c08df676c36dcf6c825fc360052142ad1900184214bba08a0d828873899ee04f44c011657  cui-vmail.sqldata.sql
9ca972fa2d28946af7a2f05923da62d3406344e815069e2ac66a17201ef622beb220a4f737dcd20a9a4738568a0935fd73cd668d79fe0f99f80ca4b756acdbde  cui-vmail.sqltable.sql
c938ee543bcf21562388b8424cd35a7b36fc6a8033e095a514788d30452843b9ac0fd6da00851623465a38d5bb6a81c5bb2da553cba4914d3e2392e602a9ad2c  cui-vmail.sqltrigger.sql
fd0d1f49df96e7be4b4efcf0802e2026c7cefcd63040b1024ddc4aa3f97379616a5f184467fe5987abce646f43c799cb97f5daa9d7654f4d99022fba184af86f  cui-vmail.sqlview.sql
95c8bfd5fcf5413d0f1a0d1b93e15a4c776b934b6e9294b478eb315e37a245a4b8582f02c89b3dd4fa503e9fa49f0aba8a99ef148ff5e2e16f1f1b3213a3edcf  cui-vmail.txt"
