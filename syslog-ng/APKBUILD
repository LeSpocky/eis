# Contributor: jv <jens@eisfair.org>
# Maintainer: jv <jens@eisfair.org>
pkgname=syslog-ng
pkgver=2.1.4
pkgrel=0
pkgdesc="Next generation logging daemon"
url="http://www.balabit.com"
arch="all"
license="GPLv2"
depends=""
depends_dev="glib-dev libeventlog-dev"
makedepends="$depends_dev"
install="$pkgname.pre-install $pkgname.post-install $pkgname.pre-deinstall $pkgname.pre-upgrade $pkgname.post-upgrade"
subpackages=""

source="http://www.balabit.com/downloads/files/syslog-ng/open-source-edition/${pkgver}/source/syslog-ng_${pkgver}.tar.gz
	syslog-ng.logrotate
	syslog-ng.initd
	syslog-ng-destination.std
	syslog-ng-filter.std
	syslog-ng-log.std
	syslog-ng-options.std
	syslog-ng-source.std
	"

_builddir="$srcdir/${pkgname}-$pkgver"

prepare() {
	cd "$_builddir"
}

build() {
	cd "$_builddir"
	./configure --prefix=/usr \
	--sysconfdir=/etc/syslog-ng \
	--enable-ipv6 \
	--disable-sql \
	--disable-mongodb \
	--disable-json \
	|| return 1
	make || return 1
}

package() {
	cd "$_builddir"
	make -j1 DESTDIR=${pkgdir} install || return 1
	rm -rf ${pkgdir}/usr/share
	install -D -m755 "$srcdir"/$pkgname.initd ${pkgdir}/etc/init.d/$pkgname || return 1
	install -D -m644 "$srcdir"/syslog-ng-destination.std ${pkgdir}/etc/syslog-ng/syslog-ng-destination.std || return 1
	install -D -m644 "$srcdir"/syslog-ng-filter.std ${pkgdir}/etc/syslog-ng/syslog-ng-filter.std || return 1
	install -D -m644 "$srcdir"/syslog-ng-log.std ${pkgdir}/etc/syslog-ng/syslog-ng-log.std || return 1
	install -D -m644 "$srcdir"/syslog-ng-options.std ${pkgdir}/etc/syslog-ng/syslog-ng-options.std || return 1
	install -D -m644 "$srcdir"/syslog-ng-source.std ${pkgdir}/etc/syslog-ng/syslog-ng-source.std || return 1
	install -D -m644 "$srcdir"/syslog-ng.logrotate ${pkgdir}/etc/logrotate.d/syslog-ng || return 1
}

md5sums="17c4c7725d2eab62b588395f1ed93f32  syslog-ng_2.1.4.tar.gz
8916d55f8213d2746e8c2a6a89c29d6c  syslog-ng.logrotate
aca6b42ddecec1fbf7cebdf158496feb  syslog-ng.initd
f0b4a0b530e269c51bc63f5b9d817c9b  syslog-ng-destination.std
d0581d312e3ffbaa9e688bfce6d54e3a  syslog-ng-filter.std
2abe3af2662fb3ac2c3dbae85ea3530a  syslog-ng-log.std
a5dad3b437c5a2a7ce13d466abd1dce4  syslog-ng-options.std
b678eb6de7a3c42c8c956a6a4462f6c7  syslog-ng-source.std"
sha256sums="e2189c7dbf617f2fc883ab0a8a86100dbe7cb4853c6b39732d77e73f335b0502  syslog-ng_2.1.4.tar.gz
a886b65863d72476504165e6a6dfe3d2922945d8cb61adb6b8eec73ac35d825e  syslog-ng.logrotate
f43112ec0a044f0860e39e773c600f77d4c187ee37b8a4ba57862081b79e8994  syslog-ng.initd
bd3097c1d8ff6754df0d7e470659827ae4d6bf86976badf5aabe4d25504fd572  syslog-ng-destination.std
8fb01460718268e4b7f5823269731ff27165458585a308cd13bbebb1b193cd68  syslog-ng-filter.std
896d4a2f1602f6340e0b5f837e050732eedb4691edc0c9f73604eb2a6eac182f  syslog-ng-log.std
fd7e5e81b441b45ef86cd1d0e95c10e718b52efe70ede0794352a122336115ac  syslog-ng-options.std
712a600b3c741004ccc9c1920acc02ce3695fa001ea83ea48cb5a77f939c62f4  syslog-ng-source.std"
sha512sums="5ff5e3a36dbcb99a3b1b36cda3336764290bd9251379244f10a48bd396785d16ed9200d746acb66f69f471d9ce1e8ec2e337afdadd109d7eba0c12d0de403ae0  syslog-ng_2.1.4.tar.gz
a062d1601f5215f60e2fc40c6ca498d768aa97af3647a9468731123a28fdd67962421b4412bfbe08a1123141b730cb78f102230ab72befec05ba7f398b39e27a  syslog-ng.logrotate
1bfb5081bced16be01f6d6e04a1287304bb0336bafb89fccbdb031fb71e68acb3722c48a0a8d32c41676d9d4f6d917293f65cb2d1781236714c0522750641b51  syslog-ng.initd
b51d8b3da9584b6cb5b5c023b5ca1085d8e4c2cfa56f6ed12fe6feb0f33a390b43825aaaf4dd74eb6b7765485fe42f7f21c74380b72de9ed2c7775787ab1e720  syslog-ng-destination.std
5eadb3503663188b45ba677cc5f7181f11bfca4ee46f92372b3f37aab8753331ca4490b1fd3d736cd28e414078115697a7dd2055f1c0923843bea0d6481642d9  syslog-ng-filter.std
e14b6d1d57f12a55caa76b5078c3545b163a34a99928502c4b3088fd5ff42cdb27bf7be931cb67c36421b12ddf74a5132745c84ac6a027d63c39b7e9c37836c4  syslog-ng-log.std
1b15c1d69e683ad57f85ae6917f448eab49c4deb99d69f0958bc2ffb0438bf9500e4e5980cd72b22ad17984bf4194c9254c4ad406a4c43cb714e8706592929ce  syslog-ng-options.std
b94c9b0a7b149b70fd2a553387c1486e769b7b131b4df45cfb85b21a6a17a71cfd1ae6d3eb9b66b94fe2521e2cfb49a465dfaa486ef0e20efea40fc4ccd7f1ad  syslog-ng-source.std"
